version: "3"
services:
  openvpn-client:
    image: ghcr.io/wfg/openvpn-client
    cap_add:
      - NET_ADMIN
    environment:
      - KILL_SWITCH=on
      - SUBNETS=192.168.0.0/24,192.168.1.0/24
    devices:
      - /dev/net/tun
    volumes:
      - openvpn:/data/vpn
    networks:
      - vpn-network
    restart: unless-stopped
  
  
  deluge:
    image: linuxserver/deluge
    container_name: deluge
    environment:
      - PUID=1000       
      - PGID=1000       
      - TZ=Etc/UTC      
    volumes:
      - deluge-config:/config
      - deluge-downloads:/downloads
    ports:
      - 58846:58846     # Daemon port
      - 58946:58946     # Torrent network port
    restart: unless-stopped
    networks:
      - vpn-network
      - caddy
    labels:
      caddy: deluge.colman.com.br
      caddy.reverse_proxy: "{{upstreams 8112}}"
  

networks:
  vpn-network:
    driver: bridge
  caddy:
    external: true
    
volumes:
  openvpn:
  deluge-config:
  deluge-downloads:
